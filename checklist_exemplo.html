<!DOCTYPE HTML>
<html lang="pt">
<head>
<meta charset="utf-8" />
<title>Plugin Checklist</title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script type="text/javascript">
/**
 * ==================================================
 * ATENÇÃO!!!!!!!!!!! SEMPRE PREENCHER A VARIÁVEL JOB
 * ==================================================
 * É ela quem diferencia um trabalho de outro no database local
 * 
 */
var job = 'exemplo';
</script>
</head>

<body>
	
	<h1>Plugin checklist</h1>
	<p>Checklist com as configurações iniciais obrigatórias ao iniciar um novo job</p>
	
	<form name="form1">
		<h2>Lista 1</h2>
		<ol>
			<li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Donec odio enim, molestie non, pretium ut, fringilla vel, libero.</li>
			<li>Nam adipiscing ultricies nisl. Sed ornare. Vivamus sodales congue ligula.</li>
			<li>Nunc purus nulla, consectetuer non, sollicitudin a, tincidunt non, arcu. Nam purus urna, consequat eu, mattis scelerisque, facilisis eu, leo.</li>
			<li>Nulla facilisi. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae;</li>
			<li>Integer libero diam, eleifend et, vestibulum non, scelerisque ut, ipsum. Ut dictum mattis libero.</li>
			<li>Duis quis arcu vel elit ultrices ornare. Donec neque dui, auctor eget, aliquet quis, tempus id, sem.</li>
			<li>Fusce sapien.Duis lectus eros, elementum vitae, egestas eu, pharetra quis, nisl. Pellentesque viverra.</li>
			<li>Pellentesque id mauris gravida metus ultricies tincidunt. Mauris adipiscing ante eu nisl.</li>
			<li>Nullam placerat pede id sem. Fusce nonummy accumsan urna. Nunc sodales tristique diam.</li>
			<li>Morbi mollis. Nam eget nisl vel ante iaculis nonummy. Praesent ultricies consequat purus.</li>
			<li>Integer eu felis. Donec id pede. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Fusce non libero.</li>
		</ol>
		
		<h2>Lista 2</h2>
		<ol>
			<li>Pellentesque id mauris gravida metus ultricies tincidunt. Mauris adipiscing ante eu nisl.</li>
			<li>Duis quis arcu vel elit ultrices ornare. Donec neque dui, auctor eget, aliquet quis, tempus id, sem.</li>
			<li>Integer libero diam, eleifend et, vestibulum non, scelerisque ut, ipsum. Ut dictum mattis libero.</li>
			<li>Integer eu felis. Donec id pede. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Fusce non libero.</li>
			<li>Fusce sapien.Duis lectus eros, elementum vitae, egestas eu, pharetra quis, nisl. Pellentesque viverra.</li>
			<li>Integer eu felis. Donec id pede. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Fusce non libero.</li>
			<li>Nullam placerat pede id sem. Fusce nonummy accumsan urna. Nunc sodales tristique diam.</li>
			<li>Morbi mollis. Nam eget nisl vel ante iaculis nonummy. Praesent ultricies consequat purus.</li>
		</ol>
		
		<!-- <input type="button" value="SALVAR" onclick="persistFavoriteMovies()"> -->
	</form>
	
<style type="text/css">
body {
	color:#333;
	font:14px arial;
	padding:10px 10px 100px;
}
ol {
	margin:10px;
}
ol li {
	padding:5px;
}
ol li:hover {
	background:#f1f1f1;
}
label {
	cursor:pointer;
}
.type_need {
	color:red;
}
.type_opti {
	color:#fea600;
}
.ok {
	opacity: 0.2;
	text-decoration:line-through;
}
.file {
	border:1px dashed #666;
	padding:1px 4px;
}
</style>
<script language="javascript">
/**
 * @link http://marxsoftware.blogspot.com.br/2011/01/html5-local-storage-web-storage.html
 * 
 */

/*
 * Indicate if this browser supports local storage.
 */
function html5StorageSupported(){
	return ('localStorage' in window) && window['localStorage'] !== null;
}

/*
 * Save favorite movies to local storage.
 */
function persistFavoriteMovies(){
	if (html5StorageSupported()){
		var $inputs = $('.save');
		$inputs.each(function(){
			var index = $(this).attr('name');
			if( $(this).is('input:checkbox') ){
				var val = $(this).is(':checked') ? 1 : 0;
			}
			else{
				var val = $(this).val();
			}
			//console.log(val);
			localStorage[index] = val;
		});
	}
	else{
		alert("Cannot save to local storage because it's not supported.");
	}
}

/*
 * Load favorite movies from local storage.
 */
function loadFavoriteMovies(){
	var $itens = $('ol li');
	// adicionar names à todos inputs
	var i = 1;
	$itens.each(function(){
		$(this).prepend('<input type="checkbox" class="save" name="'+job+'_checklist_'+i+'" />&nbsp;');
		$(this).wrapInner('<label />');
		i++;
	});
	
	if (html5StorageSupported()){
		console.log(localStorage);
		var $inputs = $('.save');
		$inputs.each(function(){
			var index = $(this).attr('name');
			//console.log( index + ' : ' + localStorage[index] );
			if( $(this).is('input:checkbox') ){
				if( localStorage[index] == 1 ){
					$(this).attr('checked', true);
					$(this).parents('li').addClass('ok');
				}
				else{
					$(this).attr('checked', false);
				}
			}
			else{
				$(this).val( localStorage[index] ) ;
			}
		});
	}
}

function checkbox(){
	$('input:checkbox').click(function(){
		if( $(this).is(':checked') ){
			$(this).parents('li').addClass('ok');
		}
		else{
			$(this).parents('li').removeClass('ok');
		}
		persistFavoriteMovies();
	});
}

jQuery(document).ready(function($){
	loadFavoriteMovies();
	checkbox();
});
</script>
</body>
</html>
